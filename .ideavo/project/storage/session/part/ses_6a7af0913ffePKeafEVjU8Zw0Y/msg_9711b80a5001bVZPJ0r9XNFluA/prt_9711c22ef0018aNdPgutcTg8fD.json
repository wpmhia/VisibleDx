{
  "id": "prt_9711c22ef0018aNdPgutcTg8fD",
  "messageID": "msg_9711b80a5001bVZPJ0r9XNFluA",
  "sessionID": "ses_6a7af0913ffePKeafEVjU8Zw0Y",
  "type": "tool",
  "tool": "edit",
  "callID": "toolu_0111EqTVJuBVXiq9jQ1eCePj",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "/home/user/project/app/case-analyzer/page.tsx",
      "oldString": "'use client'\n\nimport { useState } from 'react'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Badge } from '@/components/ui/badge'\nimport { Progress } from '@/components/ui/progress'\nimport { Alert, AlertDescription } from '@/components/ui/alert'\nimport { \n  FileText, \n  Search, \n  CheckCircle, \n  AlertTriangle, \n  Clock,\n  Brain,\n  Heart,\n  Activity,\n  Lightbulb,\n  ArrowLeft\n} from 'lucide-react'\nimport Link from 'next/link'\nimport { useTranslation } from '@/lib/language-context'\n\ninterface CaseAnalysisResult {\n  overallScore: number\n  mecfsLikelihood: 'very-high' | 'high' | 'moderate' | 'low' | 'very-low'\n  criteriaAssessment: {\n    debilitatingFatigue: boolean\n    postExertionalMalaise: boolean\n    unrefreshingSleep: boolean\n    cognitiveDifficulties: boolean\n    duration: boolean\n  }\n  redFlags: string[]\n  pemIndicators: {\n    present: boolean\n    severity: 'none' | 'mild' | 'moderate' | 'severe'\n    evidence: string[]\n  }\n  differentialDiagnoses: string[]\n  recommendations: string[]\n  keyFindings: string[]\n}\n\n// Clinical keyword patterns for analysis\nconst CLINICAL_PATTERNS = {\n  // Core ME/CFS symptoms\n  debilitatingFatigue: [\n    'severe fatigue', 'debilitating fatigue', 'exhaustion', 'extreme tiredness',\n    'profound fatigue', 'overwhelming fatigue', 'crushing fatigue'\n  ],\n  postExertionalMalaise: [\n    'post-exertional malaise', 'PEM', 'crashes after activity', 'worsens with activity',\n    'worse after exercise', 'activity intolerance', 'delayed recovery', 'payback',\n    'flare after activity', 'symptom exacerbation'\n  ],\n  unrefreshingSleep: [\n    'unrefreshing sleep', 'non-restorative sleep', 'wakes tired', 'poor sleep quality',\n    'sleep doesn\\'t help', 'still tired after sleep', 'no rest from sleep'\n  ],\n  cognitiveDifficulties: [\n    'brain fog', 'cognitive dysfunction', 'memory problems', 'concentration issues',\n    'word finding difficulties', 'mental fatigue', 'confusion', 'cognitive impairment'\n  ],\n  \n  // Duration indicators\n  duration: [\n    'months', 'chronic', 'ongoing', 'persistent', 'long-term', '6 months', 'year'\n  ],\n  \n  // Red flag symptoms\n  redFlags: [\n    'weight loss', 'fever', 'night sweats', 'lymphadenopathy', 'neurological deficits',\n    'chest pain', 'shortness of breath', 'bleeding', 'jaundice', 'seizures'\n  ],\n  \n  // Triggering events\n  triggers: [\n    'viral infection', 'flu', 'COVID', 'mononucleosis', 'stress', 'surgery',\n    'vaccination', 'bacterial infection', 'illness'\n  ],\n  \n  // Additional symptoms\n  orthostatic: [\n    'dizziness on standing', 'palpitations', 'racing heart', 'orthostatic intolerance',\n    'POTS', 'tachycardia on standing'\n  ],\n  pain: [\n    'muscle pain', 'joint pain', 'headaches', 'sore throat', 'tender lymph nodes'\n  ]\n}",
      "newString": "'use client'\n\nimport { useState } from 'react'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Badge } from '@/components/ui/badge'\nimport { Progress } from '@/components/ui/progress'\nimport { Alert, AlertDescription } from '@/components/ui/alert'\nimport { \n  FileText, \n  Search, \n  CheckCircle, \n  AlertTriangle, \n  Clock,\n  Brain,\n  Heart,\n  Activity,\n  Lightbulb,\n  ArrowLeft,\n  Droplets,\n  Shield,\n  Virus,\n  Users\n} from 'lucide-react'\nimport Link from 'next/link'\nimport { useTranslation } from '@/lib/language-context'\n\ninterface DiagnosticFramework {\n  id: string\n  name: string\n  icon: any\n  likelihood: 'very-high' | 'high' | 'moderate' | 'low' | 'very-low'\n  score: number\n  criteriaAssessment: Record<string, boolean>\n  keyFindings: string[]\n  recommendations: string[]\n  icdCode: string\n  confidence: 'high' | 'medium' | 'low'\n}\n\ninterface CaseAnalysisResult {\n  frameworks: DiagnosticFramework[]\n  redFlags: string[]\n  keyFindings: string[]\n  overallRecommendations: string[]\n  primaryDiagnosis: string | null\n  secondaryDiagnoses: string[]\n}\n\n// Comprehensive clinical keyword patterns for all diagnostic frameworks\nconst CLINICAL_PATTERNS = {\n  // ME/CFS (NICE NG206)\n  mecfs: {\n    debilitatingFatigue: [\n      'severe fatigue', 'debilitating fatigue', 'exhaustion', 'extreme tiredness',\n      'profound fatigue', 'overwhelming fatigue', 'crushing fatigue', 'disabling fatigue'\n    ],\n    postExertionalMalaise: [\n      'post-exertional malaise', 'PEM', 'crashes after activity', 'worsens with activity',\n      'worse after exercise', 'activity intolerance', 'delayed recovery', 'payback',\n      'flare after activity', 'symptom exacerbation', 'delayed symptom onset'\n    ],\n    unrefreshingSleep: [\n      'unrefreshing sleep', 'non-restorative sleep', 'wakes tired', 'poor sleep quality',\n      'sleep doesn\\'t help', 'still tired after sleep', 'no rest from sleep'\n    ],\n    cognitiveDifficulties: [\n      'brain fog', 'cognitive dysfunction', 'memory problems', 'concentration issues',\n      'word finding difficulties', 'mental fatigue', 'confusion', 'cognitive impairment'\n    ],\n    duration: [\n      'months', 'chronic', 'ongoing', 'persistent', 'long-term', '6 months', 'year', '3 months'\n    ]\n  },\n\n  // POTS\n  pots: {\n    heartRateIncrease: [\n      'tachycardia on standing', 'heart rate increase', 'racing heart when standing',\n      'palpitations standing', 'fast pulse standing', '30 bpm increase', 'HR increase'\n    ],\n    orthostatic: [\n      'dizziness on standing', 'lightheaded standing', 'orthostatic intolerance',\n      'syncope', 'presyncope', 'fainting', 'near fainting', 'dizzy when upright'\n    ],\n    symptoms: [\n      'fatigue', 'weakness', 'tremor', 'nausea', 'headache', 'mental clouding',\n      'chest discomfort', 'shortness of breath'\n    ],\n    duration: [\n      'months', 'chronic', 'ongoing', 'persistent', '6 months'\n    ]\n  },\n\n  // POTS Subtypes\n  hypovolemic: [\n    'low blood pressure', 'thirst', 'salt craving', 'volume depletion', 'dehydration',\n    'increased renin', 'low blood volume'\n  ],\n  hyperadrenergic: [\n    'high blood pressure', 'anxiety', 'panic attacks', 'migraine', 'cold hands',\n    'high norepinephrine', 'tremor', 'sweating'\n  ],\n  neuropathic: [\n    'distal neuropathy', 'GI dysfunction', 'gastroparesis', 'anhidrosis', 'pupil abnormalities',\n    'diabetes', 'autoimmune neuropathy', 'small fiber neuropathy'\n  ],\n  autoimmune: [\n    'autoimmune history', 'rapid onset', 'viral trigger', 'autoantibodies',\n    'other autoimmune conditions', 'antibodies', 'immune dysfunction', 'PAIS'\n  ],\n\n  // Long COVID\n  longCovid: {\n    covidHistory: [\n      'COVID-19', 'coronavirus', 'SARS-CoV-2', 'positive test', 'covid infection',\n      'post-covid', 'long covid', 'long-haul covid'\n    ],\n    duration: [\n      '4 weeks', 'months after covid', 'persistent symptoms', 'ongoing since covid'\n    ],\n    multisystem: [\n      'multiple symptoms', 'systemic symptoms', 'multiorgan', 'widespread symptoms'\n    ]\n  },\n\n  // Red Flags\n  redFlags: [\n    'weight loss', 'fever', 'night sweats', 'lymphadenopathy', 'neurological deficits',\n    'chest pain', 'shortness of breath', 'bleeding', 'jaundice', 'seizures',\n    'new headache', 'visual changes', 'weakness', 'sensory loss'\n  ],\n\n  // Triggers\n  triggers: [\n    'viral infection', 'flu', 'COVID', 'mononucleosis', 'stress', 'surgery',\n    'vaccination', 'bacterial infection', 'illness', 'EBV', 'CMV'\n  ]\n}"
    },
    "output": "",
    "metadata": {
      "diagnostics": {},
      "diff": "Index: /home/user/project/app/case-analyzer/page.tsx\n===================================================================\n--- /home/user/project/app/case-analyzer/page.tsx\n+++ /home/user/project/app/case-analyzer/page.tsx\n@@ -16,79 +16,127 @@\n   Brain,\n   Heart,\n   Activity,\n   Lightbulb,\n-  ArrowLeft\n+  ArrowLeft,\n+  Droplets,\n+  Shield,\n+  Virus,\n+  Users\n } from 'lucide-react'\n import Link from 'next/link'\n import { useTranslation } from '@/lib/language-context'\n \n+interface DiagnosticFramework {\n+  id: string\n+  name: string\n+  icon: any\n+  likelihood: 'very-high' | 'high' | 'moderate' | 'low' | 'very-low'\n+  score: number\n+  criteriaAssessment: Record<string, boolean>\n+  keyFindings: string[]\n+  recommendations: string[]\n+  icdCode: string\n+  confidence: 'high' | 'medium' | 'low'\n+}\n+\n interface CaseAnalysisResult {\n-  overallScore: number\n-  mecfsLikelihood: 'very-high' | 'high' | 'moderate' | 'low' | 'very-low'\n-  criteriaAssessment: {\n-    debilitatingFatigue: boolean\n-    postExertionalMalaise: boolean\n-    unrefreshingSleep: boolean\n-    cognitiveDifficulties: boolean\n-    duration: boolean\n-  }\n+  frameworks: DiagnosticFramework[]\n   redFlags: string[]\n-  pemIndicators: {\n-    present: boolean\n-    severity: 'none' | 'mild' | 'moderate' | 'severe'\n-    evidence: string[]\n-  }\n-  differentialDiagnoses: string[]\n-  recommendations: string[]\n   keyFindings: string[]\n+  overallRecommendations: string[]\n+  primaryDiagnosis: string | null\n+  secondaryDiagnoses: string[]\n }\n \n-// Clinical keyword patterns for analysis\n+// Comprehensive clinical keyword patterns for all diagnostic frameworks\n const CLINICAL_PATTERNS = {\n-  // Core ME/CFS symptoms\n-  debilitatingFatigue: [\n-    'severe fatigue', 'debilitating fatigue', 'exhaustion', 'extreme tiredness',\n-    'profound fatigue', 'overwhelming fatigue', 'crushing fatigue'\n+  // ME/CFS (NICE NG206)\n+  mecfs: {\n+    debilitatingFatigue: [\n+      'severe fatigue', 'debilitating fatigue', 'exhaustion', 'extreme tiredness',\n+      'profound fatigue', 'overwhelming fatigue', 'crushing fatigue', 'disabling fatigue'\n+    ],\n+    postExertionalMalaise: [\n+      'post-exertional malaise', 'PEM', 'crashes after activity', 'worsens with activity',\n+      'worse after exercise', 'activity intolerance', 'delayed recovery', 'payback',\n+      'flare after activity', 'symptom exacerbation', 'delayed symptom onset'\n+    ],\n+    unrefreshingSleep: [\n+      'unrefreshing sleep', 'non-restorative sleep', 'wakes tired', 'poor sleep quality',\n+      'sleep doesn\\'t help', 'still tired after sleep', 'no rest from sleep'\n+    ],\n+    cognitiveDifficulties: [\n+      'brain fog', 'cognitive dysfunction', 'memory problems', 'concentration issues',\n+      'word finding difficulties', 'mental fatigue', 'confusion', 'cognitive impairment'\n+    ],\n+    duration: [\n+      'months', 'chronic', 'ongoing', 'persistent', 'long-term', '6 months', 'year', '3 months'\n+    ]\n+  },\n+\n+  // POTS\n+  pots: {\n+    heartRateIncrease: [\n+      'tachycardia on standing', 'heart rate increase', 'racing heart when standing',\n+      'palpitations standing', 'fast pulse standing', '30 bpm increase', 'HR increase'\n+    ],\n+    orthostatic: [\n+      'dizziness on standing', 'lightheaded standing', 'orthostatic intolerance',\n+      'syncope', 'presyncope', 'fainting', 'near fainting', 'dizzy when upright'\n+    ],\n+    symptoms: [\n+      'fatigue', 'weakness', 'tremor', 'nausea', 'headache', 'mental clouding',\n+      'chest discomfort', 'shortness of breath'\n+    ],\n+    duration: [\n+      'months', 'chronic', 'ongoing', 'persistent', '6 months'\n+    ]\n+  },\n+\n+  // POTS Subtypes\n+  hypovolemic: [\n+    'low blood pressure', 'thirst', 'salt craving', 'volume depletion', 'dehydration',\n+    'increased renin', 'low blood volume'\n   ],\n-  postExertionalMalaise: [\n-    'post-exertional malaise', 'PEM', 'crashes after activity', 'worsens with activity',\n-    'worse after exercise', 'activity intolerance', 'delayed recovery', 'payback',\n-    'flare after activity', 'symptom exacerbation'\n+  hyperadrenergic: [\n+    'high blood pressure', 'anxiety', 'panic attacks', 'migraine', 'cold hands',\n+    'high norepinephrine', 'tremor', 'sweating'\n   ],\n-  unrefreshingSleep: [\n-    'unrefreshing sleep', 'non-restorative sleep', 'wakes tired', 'poor sleep quality',\n-    'sleep doesn\\'t help', 'still tired after sleep', 'no rest from sleep'\n+  neuropathic: [\n+    'distal neuropathy', 'GI dysfunction', 'gastroparesis', 'anhidrosis', 'pupil abnormalities',\n+    'diabetes', 'autoimmune neuropathy', 'small fiber neuropathy'\n   ],\n-  cognitiveDifficulties: [\n-    'brain fog', 'cognitive dysfunction', 'memory problems', 'concentration issues',\n-    'word finding difficulties', 'mental fatigue', 'confusion', 'cognitive impairment'\n+  autoimmune: [\n+    'autoimmune history', 'rapid onset', 'viral trigger', 'autoantibodies',\n+    'other autoimmune conditions', 'antibodies', 'immune dysfunction', 'PAIS'\n   ],\n-  \n-  // Duration indicators\n-  duration: [\n-    'months', 'chronic', 'ongoing', 'persistent', 'long-term', '6 months', 'year'\n-  ],\n-  \n-  // Red flag symptoms\n+\n+  // Long COVID\n+  longCovid: {\n+    covidHistory: [\n+      'COVID-19', 'coronavirus', 'SARS-CoV-2', 'positive test', 'covid infection',\n+      'post-covid', 'long covid', 'long-haul covid'\n+    ],\n+    duration: [\n+      '4 weeks', 'months after covid', 'persistent symptoms', 'ongoing since covid'\n+    ],\n+    multisystem: [\n+      'multiple symptoms', 'systemic symptoms', 'multiorgan', 'widespread symptoms'\n+    ]\n+  },\n+\n+  // Red Flags\n   redFlags: [\n     'weight loss', 'fever', 'night sweats', 'lymphadenopathy', 'neurological deficits',\n-    'chest pain', 'shortness of breath', 'bleeding', 'jaundice', 'seizures'\n+    'chest pain', 'shortness of breath', 'bleeding', 'jaundice', 'seizures',\n+    'new headache', 'visual changes', 'weakness', 'sensory loss'\n   ],\n-  \n-  // Triggering events\n+\n+  // Triggers\n   triggers: [\n     'viral infection', 'flu', 'COVID', 'mononucleosis', 'stress', 'surgery',\n-    'vaccination', 'bacterial infection', 'illness'\n-  ],\n-  \n-  // Additional symptoms\n-  orthostatic: [\n-    'dizziness on standing', 'palpitations', 'racing heart', 'orthostatic intolerance',\n-    'POTS', 'tachycardia on standing'\n-  ],\n-  pain: [\n-    'muscle pain', 'joint pain', 'headaches', 'sore throat', 'tender lymph nodes'\n+    'vaccination', 'bacterial infection', 'illness', 'EBV', 'CMV'\n   ]\n }\n \n export default function CaseAnalyzer() {\n"
    },
    "title": "app/case-analyzer/page.tsx",
    "time": {
      "start": 1758539328662,
      "end": 1758539328696
    }
  }
}